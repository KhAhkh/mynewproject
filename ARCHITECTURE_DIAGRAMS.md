# ğŸ—ï¸ System Architecture Diagrams

## 1. Overall System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          USER INTERFACE                                 â”‚
â”‚                      (React Components)                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚           ProfitReportMenuPage (Main Entry Point)               â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚  â”‚
â”‚  â”‚  â”‚ Net     â”‚ Items    â”‚ Customer â”‚ Companiesâ”‚ DateWiseâ”‚ Salesmanâ”‚â”‚  â”‚
â”‚  â”‚  â”‚ Profit  â”‚ Profit   â”‚ Profit   â”‚ Profit   â”‚ Profit  â”‚ Profit  â”‚â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Each Report Page Renders:                                      â”‚  â”‚
â”‚  â”‚  1. ProfitMetricsCard (8 colored metric boxes)                 â”‚  â”‚
â”‚  â”‚  2. Detailed table with search & sort functionality           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                         API LAYER (Express)                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  GET /api/reports/profit/net-profit        â†’ Overall Summary          â”‚
â”‚  GET /api/reports/profit/items             â†’ Item Breakdown           â”‚
â”‚  GET /api/reports/profit/customers         â†’ Customer Breakdown       â”‚
â”‚  GET /api/reports/profit/companies         â†’ Company Breakdown        â”‚
â”‚  GET /api/reports/profit/date-wise         â†’ Daily Trends             â”‚
â”‚  GET /api/reports/profit/salesmen          â†’ Salesman Details         â”‚
â”‚  GET /api/reports/profit/summary           â†’ All Invoices             â”‚
â”‚  GET /api/reports/profit/invoice/:no       â†’ Single Invoice           â”‚
â”‚                                                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                   CALCULATION ENGINE                                    â”‚
â”‚                 (profitCalculations.js)                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 7 SQL Queries + 1 JavaScript Function                          â”‚  â”‚
â”‚  â”‚                                                                 â”‚  â”‚
â”‚  â”‚ â€¢ NET_PROFIT_QUERY                                             â”‚  â”‚
â”‚  â”‚ â€¢ PROFIT_SUMMARY_QUERY                                         â”‚  â”‚
â”‚  â”‚ â€¢ PROFIT_BY_ITEM_QUERY                                         â”‚  â”‚
â”‚  â”‚ â€¢ PROFIT_BY_CUSTOMER_QUERY                                     â”‚  â”‚
â”‚  â”‚ â€¢ PROFIT_BY_COMPANY_QUERY                                      â”‚  â”‚
â”‚  â”‚ â€¢ PROFIT_BY_DATE_QUERY                                         â”‚  â”‚
â”‚  â”‚ â€¢ PROFIT_BY_SALESMAN_QUERY                                     â”‚  â”‚
â”‚  â”‚ â€¢ calculateProfitMetrics() function                            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                        DATABASE LAYER                                   â”‚
â”‚                    (No Schema Changes!)                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚    sales table               â”‚  â”‚   sale_items table           â”‚  â”‚
â”‚  â”‚                              â”‚  â”‚                              â”‚  â”‚
â”‚  â”‚ âœ“ total_amount              â”‚  â”‚ âœ“ quantity                   â”‚  â”‚
â”‚  â”‚ âœ“ amount_paid               â”‚  â”‚ âœ“ trade_price                â”‚  â”‚
â”‚  â”‚ â€¢ customer_id               â”‚  â”‚ â€¢ sale_id (FK)               â”‚  â”‚
â”‚  â”‚ â€¢ invoice_date              â”‚  â”‚ â€¢ item_id (FK)               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚    items table               â”‚  â”‚   customers table            â”‚  â”‚
â”‚  â”‚                              â”‚  â”‚                              â”‚  â”‚
â”‚  â”‚ âœ“ purchase_rate              â”‚  â”‚ â€¢ id, name, code             â”‚  â”‚
â”‚  â”‚ â€¢ id, name, code             â”‚  â”‚ â€¢ area_id                    â”‚  â”‚
â”‚  â”‚ â€¢ company_id                 â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                     â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Legend:
âœ“ = Used in profit calculations
â€¢ = Supporting data
FK = Foreign Key
```

## 2. Data Flow for Single Invoice

```
                        CUSTOMER
                            â”‚
                            â–¼
                  CREATE SALES INVOICE
                            â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚                               â”‚
            â–¼                               â–¼
     Enter Item Details            Enter Payment Info
            â”‚                               â”‚
            â–¼                               â–¼
   sales_items table             sales.total_amount
   (quantity, trade_price)        sales.amount_paid = 0
                                  sales.invoice_profit = ?
            â”‚                               â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                    PROFIT CALCULATION
                            â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                   â”‚                   â”‚
        â–¼                   â–¼                   â–¼
   invoice_profit    collection_ratio = 0    realized = 0
   = sales - cost         (unpaid)          (not yet paid)
        â”‚                   â”‚                   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                  REPORTS SHOW: 0 REALIZED
                            â”‚
                    CUSTOMER PAYMENT
                            â”‚
                    CREATE CUSTOMER RECEIPT
                            â”‚
                sales.amount_paid â† Updated!
                            â”‚
            RE-RUN PROFIT CALCULATION
                            â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                   â”‚                   â”‚
        â–¼                   â–¼                   â–¼
   invoice_profit    collection_ratio    realized = profit
   (unchanged)       = paid / total       Ã— ratio
        â”‚                   â”‚                   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
              REPORTS SHOW: UPDATED REALIZED
```

## 3. Component Hierarchy

```
App (main.jsx)
    â”‚
    â”œâ”€â”€ AppLayout
    â”‚   â”‚
    â”‚   â””â”€â”€ Routes
    â”‚       â”‚
    â”‚       â”œâ”€â”€ /reports/profit
    â”‚       â”‚   â”‚
    â”‚       â”‚   â””â”€â”€ ProfitReportMenuPage
    â”‚       â”‚       â””â”€â”€ Reports descriptions
    â”‚       â”‚           Navigation buttons
    â”‚       â”‚
    â”‚       â”œâ”€â”€ /reports/net-profit
    â”‚       â”‚   â”‚
    â”‚       â”‚   â””â”€â”€ NetProfitPage
    â”‚       â”‚       â”œâ”€â”€ ProfitMetricsCard
    â”‚       â”‚       â”‚   â””â”€â”€ 8 Metrics Display
    â”‚       â”‚       â””â”€â”€ Summary Section
    â”‚       â”‚
    â”‚       â”œâ”€â”€ /reports/items-profit-summary
    â”‚       â”‚   â”‚
    â”‚       â”‚   â””â”€â”€ ItemsProfitSummaryPage
    â”‚       â”‚       â”œâ”€â”€ ProfitMetricsCard
    â”‚       â”‚       â”œâ”€â”€ Search Input
    â”‚       â”‚       â”œâ”€â”€ Sort Dropdown
    â”‚       â”‚       â””â”€â”€ Data Table
    â”‚       â”‚
    â”‚       â”œâ”€â”€ /reports/customers-profit-summary
    â”‚       â”‚   â”‚
    â”‚       â”‚   â””â”€â”€ CustomersProfitSummaryPage
    â”‚       â”‚       â”œâ”€â”€ ProfitMetricsCard
    â”‚       â”‚       â”œâ”€â”€ Search Input
    â”‚       â”‚       â”œâ”€â”€ Sort Dropdown
    â”‚       â”‚       â””â”€â”€ Data Table
    â”‚       â”‚
    â”‚       â”œâ”€â”€ /reports/companies-profit-summary
    â”‚       â”‚   â”‚
    â”‚       â”‚   â””â”€â”€ CompaniesProfitSummaryPage
    â”‚       â”‚       â”œâ”€â”€ ProfitMetricsCard
    â”‚       â”‚       â”œâ”€â”€ Sort Dropdown
    â”‚       â”‚       â””â”€â”€ Data Table
    â”‚       â”‚
    â”‚       â”œâ”€â”€ /reports/date-wise-profit
    â”‚       â”‚   â”‚
    â”‚       â”‚   â””â”€â”€ DateWiseProfitPage
    â”‚       â”‚       â”œâ”€â”€ ProfitMetricsCard
    â”‚       â”‚       â”œâ”€â”€ Sort Dropdown
    â”‚       â”‚       â””â”€â”€ Data Table
    â”‚       â”‚
    â”‚       â””â”€â”€ /reports/salesman-profit-summary
    â”‚           â”‚
    â”‚           â””â”€â”€ SalesmanProfitSummaryPage
    â”‚               â”œâ”€â”€ ProfitMetricsCard
    â”‚               â”œâ”€â”€ Search Input
    â”‚               â”œâ”€â”€ Sort Dropdown
    â”‚               â””â”€â”€ Data Table
    â”‚
    â””â”€â”€ Other Routes...
```

## 4. Profit Calculation Flow

```
INPUT DATA FROM DATABASE
        â”‚
        â”œâ”€â”€ sales.total_amount
        â”œâ”€â”€ sales.amount_paid
        â””â”€â”€ sale_items.quantity Ã— items.purchase_rate
        
        â”‚
        â–¼
   
   STEP 1: Calculate Total Cost
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ SUM(quantity Ã— purchase_rate)    â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
   
   STEP 2: Calculate Invoice Profit
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ total_amount - total_cost        â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
   
   STEP 3: Calculate Collection Ratio
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ amount_paid / total_amount Ã— 100 â”‚
   â”‚ (Returns percentage)             â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
   
   STEP 4: Calculate Realized Profit
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ invoice_profit Ã— collection_ratioâ”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
   
   STEP 5: Calculate Unrealized Profit
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ invoice_profit - realized_profit â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
   
   STEP 6: Calculate Outstanding Amount
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ total_amount - amount_paid       â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
   
   OUTPUT: All 8 Metrics
   â”œâ”€â”€ Total Sales
   â”œâ”€â”€ Cost of Sales
   â”œâ”€â”€ Invoice Profit
   â”œâ”€â”€ Amount Paid
   â”œâ”€â”€ Collection Ratio
   â”œâ”€â”€ Outstanding Amount
   â”œâ”€â”€ Realized Profit âœ¨
   â””â”€â”€ Unrealized Profit âœ¨
```

## 5. Partial Payment Scenario

```
SCENARIO: Invoice for Rs. 10,000
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

INITIAL STATE (No Payment)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Total Sales:           10,000 â”
Cost:                   6,000 â”œâ”€â†’ Invoice Profit: 4,000
                              â”˜
Amount Paid:               0  â”
Outstanding:          10,000 â”œâ”€â†’ Collection Ratio: 0%
                              â”˜
Realized Profit:            0 âœ— (No cash received)
Unrealized Profit:      4,000 â³ (All pending)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

AFTER 30% PAYMENT (Rs. 3,000)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Total Sales:           10,000 â”
Cost:                   6,000 â”œâ”€â†’ Invoice Profit: 4,000 (same)
                              â”˜
Amount Paid:            3,000 â”
Outstanding:            7,000 â”œâ”€â†’ Collection Ratio: 30%
                              â”˜
Realized Profit:        1,200 âœ“ (4,000 Ã— 30%)
Unrealized Profit:      2,800 â³ (4,000 Ã— 70%)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

AFTER FINAL PAYMENT (Rs. 7,000)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Total Sales:           10,000 â”
Cost:                   6,000 â”œâ”€â†’ Invoice Profit: 4,000 (same)
                              â”˜
Amount Paid:           10,000 â”
Outstanding:               0  â”œâ”€â†’ Collection Ratio: 100%
                              â”˜
Realized Profit:        4,000 âœ“âœ“ (All profit realized!)
Unrealized Profit:          0  âœ“ (Nothing pending)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
KEY INSIGHT: Realized Profit increases with each payment!
```

## 6. Database Query Structure

```
SELECT
  â”‚
  â”œâ”€â”€ Aggregated Fields
  â”‚   â”œâ”€â”€ SUM(sales.total_amount) as total_sales
  â”‚   â”œâ”€â”€ SUM(quantity Ã— purchase_rate) as total_cost
  â”‚   â”œâ”€â”€ SUM(sales.amount_paid) as total_amount_paid
  â”‚   â””â”€â”€ SUM(total_sales - amount_paid) as outstanding
  â”‚
  â”œâ”€â”€ Calculated Fields
  â”‚   â”œâ”€â”€ total_sales - total_cost = invoice_profit
  â”‚   â”œâ”€â”€ (amount_paid / total_sales) Ã— 100 = collection_ratio
  â”‚   â”œâ”€â”€ invoice_profit Ã— collection_ratio = realized_profit
  â”‚   â””â”€â”€ invoice_profit - realized_profit = unrealized_profit
  â”‚
  â””â”€â”€ Optional Grouping
      â”œâ”€â”€ GROUP BY item_id (for items profit)
      â”œâ”€â”€ GROUP BY customer_id (for customer profit)
      â”œâ”€â”€ GROUP BY DATE(invoice_date) (for daily profit)
      â”œâ”€â”€ GROUP BY salesman_id (for salesman profit)
      â””â”€â”€ GROUP BY company_id (for company profit)

FROM
  sales s
  LEFT JOIN sale_items si ON s.id = si.sale_id
  LEFT JOIN items i ON si.item_id = i.id
  LEFT JOIN customers c ON s.customer_id = c.id
  LEFT JOIN salesmen sm ON s.salesman_id = sm.id
```

## 7. UI Metric Display Layout

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ENTIRE NET PROFIT (or whatever report selected)               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  TOTAL   â”‚  â”‚  COST OF â”‚  â”‚ INVOICE  â”‚  â”‚ AMOUNT   â”‚      â”‚
â”‚  â”‚  SALES   â”‚  â”‚  SALES   â”‚  â”‚ PROFIT   â”‚  â”‚  PAID    â”‚      â”‚
â”‚  â”‚          â”‚  â”‚          â”‚  â”‚          â”‚  â”‚          â”‚      â”‚
â”‚  â”‚ 10,000   â”‚  â”‚ 6,000    â”‚  â”‚ 4,000    â”‚  â”‚ 5,000    â”‚      â”‚
â”‚  â”‚          â”‚  â”‚          â”‚  â”‚          â”‚  â”‚          â”‚      â”‚
â”‚  â”‚  ğŸ”µ Blue â”‚  â”‚ ğŸŸ  Orangeâ”‚  â”‚ ğŸŸ¢ Green â”‚  â”‚ ğŸŸ£ Purpleâ”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚COLLECTIONâ”‚  â”‚OUTSTANDINGâ”‚ â”‚ REALIZED â”‚  â”‚UNREALIZEDâ”‚      â”‚
â”‚  â”‚  RATIO   â”‚  â”‚  AMOUNT   â”‚ â”‚ PROFIT   â”‚  â”‚ PROFIT   â”‚      â”‚
â”‚  â”‚          â”‚  â”‚          â”‚  â”‚          â”‚  â”‚          â”‚      â”‚
â”‚  â”‚  50%     â”‚  â”‚ 5,000    â”‚  â”‚ 2,000    â”‚  â”‚ 2,000    â”‚      â”‚
â”‚  â”‚          â”‚  â”‚          â”‚  â”‚          â”‚  â”‚          â”‚      â”‚
â”‚  â”‚ ğŸ”· Cyan  â”‚  â”‚ ğŸ”´ Red   â”‚  â”‚ğŸ’š Emeraldâ”‚  â”‚ ğŸŸ¡ Yellowâ”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Calculation Details:                                           â”‚
â”‚ â€¢ Invoice Profit = Sales - Cost                               â”‚
â”‚ â€¢ Collection Ratio = Paid / Sales                             â”‚
â”‚ â€¢ Realized = Profit Ã— Collection Ratio  âœ¨                    â”‚
â”‚ â€¢ Unrealized = Profit - Realized  âœ¨                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

These diagrams show the complete system architecture, data flow, calculation process, and UI layout for the profit calculation system.
